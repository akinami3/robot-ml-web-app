version: '3.9'
services:
  backend:
    build:
      context: ..
      dockerfile: docker/backend.Dockerfile
    env_file:
      - ../.env.example
    ports:
      - "8000:8000"
    volumes:
      - ../backend:/app/backend
      - ../data:/app/data
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --app-dir backend

  frontend:
    build:
      context: ..
      dockerfile: docker/frontend.Dockerfile
    ports:
      - "5173:5173"
    volumes:
      - ../frontend:/app/frontend
    command: npm run dev -- --host 0.0.0.0 --port 5173

  mqtt:
    image: eclipse-mosquitto:2.0
    ports:
      - "1883:1883"
    volumes:
      - ./mqtt.conf:/mosquitto/config/mosquitto.conf
